# 📄 要件定義書：ドキュメント自動作成アプリ

---

## 1. 概要

本アプリは、日々の業務における作業ログを記録・集積し、それらを週報・月報などのドキュメント形式に自動要約・整形するための**ローカルアプリケーション**である。オフラインで動作し、Windows環境向けに`.exe`形式で配布されることを前提とする。

---

## 2. 目的

- 作業ログを効率的に集計・整形・要約することにより、報告書作成業務を大幅に省力化
- テンプレート選択によりフォーマットの一貫性を担保
- 出力形式を柔軟に選択可能とし、他部門・取引先との情報共有を円滑にする
- 完全オフライン動作によりセキュリティを確保

---

## 3. 動作環境・制約

| 項目 | 内容 |
|------|------|
| 対応OS | Windows 10 / 11 |
| 実行形式 | 単体 `.exe` ファイル（約93MB） |
| ネットワーク要件 | オフライン動作（完全ローカル） |
| 外部依存 | なし（オープンソースライブラリのみ使用） |
| 言語 | 日本語対応 |

---

## 4. 機能要件

### 4.1 作業ログ入力機能
- 日ごとの作業内容をプレーンテキストで入力、保存可能
- 直感的なGUI操作（日付選択、テキスト入力、タグ付け）
- 日付単位でローカルに保存（JSON形式）
- 自動保存機能（30秒間隔）
- ログ履歴表示と統計情報
- ショートカットキー対応（Ctrl+C, Ctrl+V, Ctrl+S, Ctrl+N）

### 4.2 テンプレート選択機能
- あらかじめ用意された5種類のテンプレート:
    - 日報（daily_report）
    - 週報（weekly_report）
    - 月報（monthly_report）
    - 業務報告書（business_report）
    - 進捗報告書（progress_report）
- テンプレート構造はYAML形式で定義
- リアルタイムプレビュー機能
- 簡素化された構成（基本情報、内容、成果、今後の予定、備考）

### 4.3 自動要約機能
- TextRankベースの抽出型要約（標準実装）
- 重要語句・文章の自動抽出
- 日本語分割処理（tinysegmenter使用）
- 期間指定による一括要約生成
- キーワード抽出機能

### 4.4 出力機能
- 以下のフォーマットで出力対応：
    - `.txt`（プレーンテキスト）
    - `.csv`（表形式）
    - `.xlsx`（Excel帳票）
    - `.docx`（Word文書）
- 出力前プレビュー機能
- 出力先ディレクトリをGUIで指定可能
- テンプレート適用による構造化出力

---

## 5. 非機能要件

| 項目 | 内容 |
|------|------|
| 実行速度 | 1週間分のログで10秒以内の要約処理完了 |
| セキュリティ | 完全ローカル処理、インターネット通信不要 |
| 操作性 | 3タブ構成で最小限の操作で処理完結可能 |
| 可搬性 | 単体exeファイルで持ち運び可能 |
| 日本語対応 | 完全日本語UI、日本語文章処理対応 |

---

## 6. 使用ライブラリ（実装済み）

| 分類 | ライブラリ | 用途 |
|------|-------------|------|
| GUI | PySide6 | ユーザーインターフェース |
| 要約 | sumy（TextRank）, tinysegmenter | 抽出型要約、日本語分割 |
| 出力 | openpyxl, python-docx, csv | 各種ファイル出力処理 |
| 日本語処理 | janome | 日本語形態素解析 |
| 設定管理 | pyyaml | 設定・テンプレート管理 |
| exe化 | pyinstaller | 単体アプリ作成 |

---

## 7. GUI構成

### 7.1 タブ構成
- **📝 ログ入力タブ**: 作業内容の入力・保存
- **📋 テンプレート選択タブ**: 出力テンプレートの選択・設定
- **📤 出力設定タブ**: 要約生成・プレビュー・出力実行

### 7.2 主要コンポーネント
- メインウィンドウ（1200x800）
- メニューバー（ファイル、編集、ヘルプ）
- ステータスバー（状態表示）
- タブウィジェット（3タブ）

---

## 8. データ構造

### 8.1 作業ログ（JSON形式）
```json
{
  "date": "2024-01-15",
  "content": "作業内容",
  "tags": ["会議", "開発"],
  "created_at": "2024-01-15T18:00:00",
  "updated_at": "2024-01-15T18:00:00"
}
```

### 8.2 テンプレート（YAML形式）
```yaml
id: daily_report
name: 日報
description: 日報テンプレート
sections:
  - name: header
    title: 基本情報
    fields:
      - name: target_date
        type: date
        required: true
```

---

## 9. 開発完了状況

### 9.1 実装完了機能
- ✅ 基本GUI構成（3タブ）
- ✅ ログ入力・保存機能
- ✅ テンプレート選択機能
- ✅ 要約生成機能（TextRank）
- ✅ 複数形式出力機能
- ✅ プレビュー機能
- ✅ ショートカットキー対応
- ✅ 実行ファイル化（PyInstaller）

### 9.2 テンプレート実装状況
- ✅ 日報テンプレート
- ✅ 週報テンプレート
- ✅ 月報テンプレート
- ✅ 業務報告書テンプレート
- ✅ 進捗報告書テンプレート

---

## 10. 配布パッケージ

### 10.1 実行ファイル
- `dist\AutoMakeDocument.exe`（約93MB）
- 依存関係すべて含む単体実行ファイル

### 10.2 ドキュメント
- `操作手順書.md`：詳細な操作マニュアル
- `クイックスタートガイド.md`：初心者向けガイド
- `ビルド手順.md`：開発者向けビルド手順

### 10.3 プロジェクト構成
```
AutoMakeDocument/
├── src/                    # ソースコード
├── templates/             # テンプレートファイル
├── config/               # 設定ファイル
├── data/                 # データ保存
├── output/               # 出力ファイル
├── dist/                 # 実行ファイル
└── docs/                 # ドキュメント
```

---

## 11. 今後の拡張予定

### 11.1 機能拡張
- カスタムテンプレート作成機能
- 統計・分析機能の強化
- 画像・図表の挿入機能
- 複数言語対応

### 11.2 性能改善
- 大量データ処理の最適化
- 起動時間の短縮
- メモリ使用量の削減

---

## 12. 留意点

- 完全にオフラインで動作し、セキュリティを確保
- 日本語文章処理に特化した実装
- 継続的な使用を前提とした設計
- 企業環境での使用を想定したファイル形式対応
