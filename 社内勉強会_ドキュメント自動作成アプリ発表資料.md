# 社内勉強会発表資料
## ドキュメント自動作成アプリの開発

---

## 1. 今回開発したもの

### 📄 ドキュメント自動作成アプリ
**日々の作業ログを記録・集積し、週報・月報などのドキュメント形式に自動整形するローカルアプリケーション**

### 主要機能

#### 📝 作業ログ入力機能
- 日ごとの作業内容をプレーンテキストで入力・保存
- 直感的なGUIでの入力操作
- 日付単位でのローカル保存（JSON形式）
- 自動保存機能とショートカットキー対応

#### 📋 テンプレート選択機能
- あらかじめ用意されたテンプレートから形式を選択
  - 日報／週報／月報／業務報告書／進捗報告書
- YAML形式でのユーザー定義テンプレート対応
- リアルタイムプレビュー機能

#### 📤 出力機能
- 複数フォーマットでの出力対応：
  - `.txt`（プレーンテキスト）
  - `.csv`（表形式）
  - `.xlsx`（Excel帳票）
  - `.docx`（Word文書）
- 出力前プレビュー機能
- 出力先ディレクトリのGUI指定

### システム特徴
- **オフライン動作** - 完全ローカル環境で動作
- **ポータブル版** - ZIP展開するだけで使用可能
- **権限問題なし** - 書き込み権限を気にせず使用可能
- **日本語対応** - 完全な日本語環境

---

## 2. 開発の背景

### 🎯 開発動機
現場でドキュメント作成する機会が頻繁にあり、以下のような課題を感じていました：

- **手作業による非効率性**
  - 毎週の週報作成に時間がかかる
  - 作業ログの整理と文書化が煩雑
  - 同じような内容を何度も書く必要がある

- **標準化の必要性**
  - 報告書のフォーマットが統一されていない
  - 個人によって書き方がバラバラ
  - 過去の作業内容を参照しにくい

### 💡 解決したい課題
**「日々の作業ログを効率的に管理し、定期的なドキュメント作成を自動化できたら便利」**

この考えから、業務効率化を目指してアプリケーションの開発を開始しました。

---

## 3. 使用技術・どのようにつくったか

### 🛠️ 技術スタック

#### フロントエンド（GUI）
```
PySide6 (Qt for Python)
- モダンなクロスプラットフォームGUIフレームワーク
- 豊富なウィジェットとレイアウト機能
- 日本語対応とテーマ機能
```

#### バックエンド（データ処理）
```
Python 3.13
- pandas: データ処理・分析
- PyYAML: 設定ファイル・テンプレート処理
- python-dateutil: 日付操作
- chardet: 文字エンコーディング判定
```

#### ファイル出力
```
openpyxl: Excel形式出力
python-docx: Word文書出力
xlsxwriter: Excel詳細制御
csv: CSV形式出力
```

#### 実行ファイル作成
```
PyInstaller: Python → .exe 変換
- --onefile: 単一実行ファイル
- --windowed: コンソールなし
- --add-data: リソースファイル同梱
```

### 🏗️ アーキテクチャ設計

```
AutoMakeDocument/
├── src/
│   ├── gui/          # GUI コンポーネント
│   │   ├── main_window.py      # メインウィンドウ
│   │   ├── log_input.py        # ログ入力画面
│   │   ├── template_selector.py # テンプレート選択
│   │   ├── summary_view.py     # プレビュー画面
│   │   └── output_config.py    # 出力設定
│   ├── core/         # コア機能
│   │   ├── data_manager.py     # データ管理
│   │   ├── template_engine.py  # テンプレート処理
│   │   └── summarizer.py       # 要約機能
│   ├── utils/        # ユーティリティ
│   │   ├── config_manager.py   # 設定管理
│   │   ├── logger.py           # ログ機能
│   │   ├── file_utils.py       # ファイル操作
│   │   └── date_utils.py       # 日付操作
│   └── output/       # ファイル出力処理
├── data/
│   └── logs/         # 作業ログ（JSON形式）
├── templates/        # レポートテンプレート（YAML形式）
├── config/          # 設定ファイル
└── assets/          # リソースファイル
```

### 🔄 開発フロー

1. **要件定義・設計**
   - 機能要件の洗い出し
   - UI/UXの検討
   - アーキテクチャ設計

2. **プロトタイプ開発**
   - 基本的なGUI作成
   - データ構造の設計
   - テンプレートシステムの実装

3. **機能実装**
   - 各種出力フォーマット対応
   - プレビュー機能
   - 設定管理機能

4. **テスト・デバッグ**
   - 各機能の動作確認
   - エラーハンドリング
   - 実行ファイル化

5. **配布・運用**
   - GitHub Releasesでの配布
   - ポータブル版の作成

---

## 4. 開発に際してだいへんだったこと

### 😅 主な困難とその解決策

#### 1. **ログデータのテンプレート出力処理**
**問題：** ログとして貯めたデータをテンプレートに出力する部分のテストに時間がかかった

**具体的な課題：**
- JSON形式で保存されたログデータの構造化
- YAML形式のテンプレートとの適切なマッピング
- 日付範囲指定での複数ログの統合処理
- テンプレート変数の動的置換

**解決アプローチ：**
```python
# テンプレート処理のロジック例
def process_template(template_data, log_data):
    # ログデータの正規化
    normalized_logs = normalize_log_data(log_data)
    
    # テンプレート変数の置換
    processed_content = replace_template_variables(
        template_data, normalized_logs
    )
    
    return processed_content
```

#### 2. **プレビューとファイル出力の乖離**
**問題：** プレビューはできても出力はエラーになることがあった

**原因分析：**
- プレビュー画面とファイル出力で異なる処理パスを使用
- 文字エンコーディングの問題
- ファイル形式固有の制約（Excel、Wordなど）

**解決策：**
- プレビューとファイル出力で共通の処理ロジックを使用
- 文字エンコーディングの統一（UTF-8）
- ファイル形式別のバリデーション追加

#### 3. **要約機能の複雑性**
**問題：** 要約機能が原因でエラーが頻発し、開発が停滞

**検討した要約機能：**
- 自然言語処理ライブラリ（janome, sumy）の活用
- 作業ログの自動要約・キーワード抽出
- 重要度に応じた文章の優先順位付け

**最終的な判断：**
**要約機能を一旦削除し、シンプルな構成に変更**

**理由：**
- 要約精度が期待値に達しなかった
- 処理時間が長く、ユーザビリティが低下
- 実行ファイルサイズが大幅に増加
- 核となる機能（ログ入力・テンプレート出力）に集中

### 🎯 学んだこと

1. **機能の優先順位付けの重要性**
   - 完璧を求めすぎず、MVP（Minimum Viable Product）を意識
   - ユーザーにとって本当に必要な機能の見極め

2. **テストの重要性**
   - 統合テストの早期実施
   - 実際の利用シーンを想定したテストケース

3. **技術選定の判断基準**
   - 機能の複雑さ vs 実用性のバランス
   - 保守性と拡張性の考慮

---

## 5. 今後の展望

### 🚀 追加したい機能
- **要約機能の再実装**（より軽量なアプローチで）
- **チーム連携機能**（共有フォルダでのデータ同期）
- **カスタムテンプレート作成支援**
- **データ分析・可視化機能**

### 📈 改善ポイント
- **処理速度の最適化**
- **より直感的なUI/UX**
- **エラーハンドリングの強化**
- **ログの検索・フィルタリング機能**

---

## 6. まとめ

### ✨ 開発成果
- **業務効率化** - 手作業によるドキュメント作成時間を大幅削減
- **標準化** - 統一されたフォーマットでの報告書作成
- **実用性** - 実際の業務で使用可能なレベルの品質

### 🎓 技術的な学び
- **GUI アプリケーション開発** - PySide6を使ったデスクトップアプリ
- **データ処理** - JSON/YAML形式でのデータ管理
- **実行ファイル作成** - PyInstallerを使った配布可能な形式
- **プロジェクト管理** - 要件定義から配布まで一貫した開発体験

### 💡 今後の活用
本アプリケーションは現在 **GitHub Releases** で配布しており、
誰でも無料でダウンロード・使用可能です。

**GitHub Repository:**
https://github.com/s-oshima-kops/AutoMakeDocument

---

**ご清聴ありがとうございました**

*質問・フィードバックお待ちしております* 