# 📄 ドキュメント自動要約&作成アプリ

## 概要

このアプリケーションは、日々の業務における作業ログを記録・集積し、それらを週報・月報などのドキュメント形式に自動要約・整形するための**ローカルアプリケーション**です。オフラインで動作し、Windows環境向けに`.exe`形式で配布することを前提としています。

## 主な機能

### 📝 作業ログ入力機能
- 日ごとの作業内容をプレーンテキストで貼り付け、保存可能
- 直感的なGUIでの入力操作
- 日付単位でのローカル保存（JSON形式）

### 📋 テンプレート選択機能
- あらかじめ用意されたテンプレートから形式を選択可能
  - 日報／週報／月報／業務報告書／進捗報告書
- YAML形式でのユーザー定義テンプレート対応

### 🤖 自動要約機能
- TextRankベースの抽出型要約（標準実装）
- ローカルLLMによる生成型要約（オプション）
- 重要語句・文章の自動抽出

### 📊 集計・整形機能
- 保存された作業ログを週単位・月単位で一括取得
- テンプレートに応じたレイアウト・構成の自動整形
- マークダウン形式での中間整形

### 📤 ファイル出力機能
- 複数フォーマットでの出力対応：
  - `.txt`（プレーンテキスト）
  - `.csv`（表形式）
  - `.xlsx`（Excel帳票）
  - `.docx`（Word文書）
- 出力先ディレクトリのGUI指定

## システム要件

| 項目 | 内容 |
|------|------|
| 対応OS | Windows 10 / 11 |
| 実行形式 | 単体 `.exe` ファイル |
| ネットワーク | オフライン動作（完全ローカル） |
| 外部依存 | なし（オープンソースライブラリのみ使用） |
| 言語 | 日本語対応 |

## インストール方法

### 開発環境でのセットアップ

1. **リポジトリのクローン**
   ```bash
   git clone <repository-url>
   cd AutoMakeDocument
   ```

2. **Python環境の準備**
   ```bash
   python -m venv venv
   # Windows
   venv\Scripts\activate
   # Linux/Mac
   source venv/bin/activate
   ```

3. **依存関係のインストール**
   ```bash
   pip install -r requirements.txt
   ```

4. **アプリケーションの起動**
   ```bash
   python main.py
   ```

### 実行ファイルのビルド

```bash
python build.py
```

ビルド完了後、`dist/AutoMakeDocument.exe`が生成されます。

## 📚 ドキュメント

詳細なドキュメントは [`docs/`](docs/) ディレクトリをご覧ください：

- **[クイックスタートガイド](docs/クイックスタートガイド.md)** - 5分で始められる初心者向けガイド
- **[操作手順書](docs/操作手順書.md)** - 詳細な操作マニュアル
- **[ビルド手順](docs/ビルド手順.md)** - 実行ファイル作成手順
- **[要件定義書](docs/要件定義書_ドキュメント自動要約アプリ.md)** - システム仕様

## 使用方法

### クイックスタート
1. **アプリケーション起動** - `AutoMakeDocument.exe`をダブルクリック
2. **ログ入力** - 「📝 ログ入力」タブで作業内容を入力・保存
3. **要約生成** - 「📊 要約表示」タブで期間を選択して要約実行
4. **ファイル出力** - 「📤 出力設定」タブで形式を選択して出力

詳細な使い方は **[クイックスタートガイド](docs/クイックスタートガイド.md)** または **[操作手順書](docs/操作手順書.md)** をご参照ください。

## 技術仕様

### 使用ライブラリ

| 分類 | ライブラリ | 用途 |
|------|-------------|------|
| GUI | PySide6 | ユーザーインターフェース |
| 要約 | sumy（TextRank）, llama.cpp | 抽出・生成型要約 |
| 出力 | openpyxl, python-docx, csv | 各種ファイル出力処理 |
| 実行ファイル化 | PyInstaller | 単体アプリ作成 |

### アーキテクチャ

```
AutoMakeDocument/
├── src/
│   ├── gui/          # GUI コンポーネント
│   ├── core/         # コア機能（要約、テンプレート処理）
│   ├── utils/        # ユーティリティ関数
│   └── output/       # ファイル出力処理
├── data/
│   └── logs/         # 作業ログ（JSON形式）
├── templates/        # レポートテンプレート（YAML形式）
├── config/          # 設定ファイル
└── assets/          # リソースファイル
```

## 設定ファイル

### アプリケーション設定（config/app_config.yaml）
```yaml
app_name: "ドキュメント自動要約&作成アプリ"
version: "1.0.0"
language: "ja"
window:
  width: 1200
  height: 800
```

### ユーザー設定（config/user_settings.json）
```json
{
  "last_template": "weekly_report",
  "output_format": "docx",
  "output_directory": "",
  "auto_save": true
}
```

## テンプレートのカスタマイズ

新しいテンプレートを作成するには、`templates/`ディレクトリに新しいYAMLファイルを追加します：

```yaml
id: custom_report
name: カスタムレポート
description: カスタムレポートテンプレート
sections:
  - name: header
    title: 基本情報
    fields:
      - name: title
        type: text
        required: true
```

## トラブルシューティング

### よくある問題

1. **アプリケーションが起動しない**
   - Python 3.8以上がインストールされているか確認
   - 依存関係が正しくインストールされているか確認

2. **要約が生成されない**
   - 作業ログが保存されているか確認
   - 要約対象期間にデータが存在するか確認

3. **ファイル出力ができない**
   - 出力先ディレクトリの書き込み権限を確認
   - ディスクの空き容量を確認

### ログの確認

アプリケーションのログは `data/app.log` に記録されます。問題が発生した場合は、このファイルを確認してください。

## 開発情報

### バージョン履歴

- v1.0.0 (2024-01-01): 初回リリース
  - 基本的な要約・出力機能の実装
  - 5種類のテンプレート対応
  - オフライン動作対応

### 貢献方法

1. このリポジトリをフォーク
2. フィーチャーブランチを作成
3. 変更をコミット
4. プルリクエストを送信

### ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## サポート

質問や問題がある場合は、以下の方法でお問い合わせください：

- GitHub Issues: プロジェクトページで新しいIssueを作成
- メール: [support@example.com](mailto:support@example.com)

---

**Auto Make Document Team**  
© 2024 All Rights Reserved 